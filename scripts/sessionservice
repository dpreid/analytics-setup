#!/bin/bash
# example sessionservice 
cd ../autogenerated
DIR=.
filename='./(\w*).\w*.(\w*)'

for i in $DIR/log.access.*; do
	[[ $i =~ $filename ]]
	dest="${BASH_REMATCH[2]}"
	out="log-${dest}.service"
	dest="$dest" envsubst < ../files/template.service > "$out"
done


# write a script to enable and start these services
rm ./enable-logging-clients.sh
echo "#!/bin/bash"
for i in $DIR/log.access.*; do
	[[ $i =~ $filename ]]
	dest="${BASH_REMATCH[2]}"
	service="$dest" envsubst < ../files/template.start >> ./enable-logging-clients.sh
done
chmod +x ./enable-logging-clients.sh
